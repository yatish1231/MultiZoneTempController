package com.ypitta.MultiZoneClimateControl.gateway_device.callBack;

import java.util.logging.Logger;

import com.amazonaws.services.iot.client.AWSIotMessage;
import com.amazonaws.services.iot.client.AWSIotQos;
import com.amazonaws.services.iot.client.AWSIotTopic;
import com.ypitta.MultiZoneClimateControl.gateway_device.MqttClient.MqttClientConnector;
import com.ypitta.MultiZoneClimateControl.gateway_device.common.AWSActuatorData;
import com.ypitta.MultiZoneClimateControl.gateway_device.common.ActuatorData;
import com.ypitta.MultiZoneClimateControl.gateway_device.common.ConfigUtil;
import com.ypitta.MultiZoneClimateControl.gateway_device.common.DataUtil;
import com.ypitta.MultiZoneClimateControl.gateway_device.common.

public class AWSTopicCallBack extends AWSIotTopic{
	
	private MqttClientConnector publisher;
	
	private DataUtil util;
	
	private ConfigUtil util_config;
	
	private String topic_publisher;
	
	private final static Logger LOGGER = Logger.getLogger(Logger.GLOBAL_LOGGER_NAME);
	
	public AWSTopicCallBack(String topic, AWSIotQos qos, MqttClientConnector publisher,String pub_topic) {
		super(topic, qos);
		this.publisher = publisher;
		this.topic_publisher = pub_topic;
		this.util = new DataUtil();
		this.util_config = new ConfigUtil();
		// TODO Auto-generated constructor stub
	}

	@Override
	public void onMessage(AWSIotMessage message) {
		// TODO Auto-generated method stub
		String payload = new String(message.getPayload());
		AWSActuatorData data = this.util.toAWSActuatorDatafromJson(payload);
		ActuatorData new_data = new ActuatorData();
		new_data.setCommand(data.getAction());
		new_data.setName(data.getZoneId());
		new_data.setCurValue(10.0);
	}
	
	public MqttClientConnector getPublisher() {
		return publisher;
	}

	public void setPublisher(MqttClientConnector publisher) {
		this.publisher = publisher;
	}

	
}
