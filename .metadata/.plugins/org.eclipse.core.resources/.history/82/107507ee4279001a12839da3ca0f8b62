package com.ypitta.MultiZoneClimateControl.gateway_device.MqttClient;

import com.amazonaws.services.iot.client.AWSIotException;
import com.amazonaws.services.iot.client.AWSIotMqttClient;
import com.ypitta.MultiZoneClimateControl.gateway_device.callBack.AWSTopicCallBack;

public class AWSTopicSubscriber implements Runnable{
	
	private AWSIoTMqttClientSecure secureClient;
	
	private AWSTopicCallBack topic;
	
	
	public AWSTopicSubscriber(AWSIoTMqttClientSecure secureClient, AWSTopicCallBack topic) {
		super();
		this.secureClient = secureClient;
		this.topic = topic;
	}

	public void subscribeToAWSTopic() {
		if(secureClient != null && topic != null) {
			try {
				this.secureClient.getClientInstance().subscribe(this.topic);
			} catch (AWSIotException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		}
		
	}

	@Override
	public void run() {
		// TODO Auto-generated method stub
		this.subscribeToAWSTopic();
	}

	
}
